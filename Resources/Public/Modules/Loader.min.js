var g=document.head,u={},l="data-loader",m=e=>!(e===void 0||e==="false");function T({callback:e=()=>{},rootElement:t=document,markup:n=""}={}){if(n){if(!n.includes(` ${l}`)){e();return}t=document.createRange().createContextualFragment(`<template>${n}</template>`).firstElementChild.content}let a=[...t.querySelectorAll(`[${l}]`)];if(!n&&a.length===0){e();return}let o=[],s=[];return a.forEach(i=>{let r=i.dataset,c=!m(r.noCache),d=m(r.debug);r?.css&&(s=[...s,...f(r.css,"css",c,d)]),r?.mjs&&(o=[...o,...f(r.mjs,"mjs",c,d)]),r?.js&&(o=[...o,...f(r.js,"js",c,d)])}),s=[...new Set(s)],o=[...new Set(o)],p(s).then(()=>{o.length||e()}),p(o).then(e),{styles:s,scripts:o}}function p(e){return e instanceof Array?Promise.all(e.map(h)):h(e)}function f(e,t,n=!0,a=!1){return e.split(",").map(o=>({url:o,type:t,useCache:n,debug:a}))}function h({url:e,type:t,useCache:n,debug:a}){if(!e)throw new Error("LOADER: You must provide a url to load");let o=u[e];if(o)return a&&console.log("LOADER: cache hit",e),o;{let r=t==="css"?S(e):E(e);if(r){let c=Promise.resolve(r);return e&&(u[e]=c),c}}let s=t==="css"?j({url:e}):O({url:e,type:t}),i=y(s);return n&&(u[e]=i),i}function y(e){return new Promise(function(t,n){let a=!1;e.onload=e.onreadystatechange=function(){!a&&(!e.readyState||e.readyState==="loaded"||e.readyState==="complete")&&(a=!0,e.onload=e.onreadystatechange=null,t(e))},e.onerror=n,g.appendChild(e)})}function E(e){return L(e&&document.querySelector(`script[src='${e}']`))}function S(e){return L(e&&document.querySelector(`link[href='${e}']`))}function L(e){if(e&&e.dataset.marker!=="true")return e}function j({url:e}){if(!e)return;let t=document.createElement("link");return t.rel="stylesheet",t.href=e,t.dataset.marker="true",t}function O({url:e,type:t}){if(!e)return;let n=document.createElement("script");return t==="mjs"&&(n.type="module"),n.defer=!0,n.dataset.marker="true",n.src=e,n}export{p as Loader,f as LoaderMap,T as default,T as initLoader};
